<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="Joern Kiwitt">
    <link rel="icon" href="media/favicon.ico">

    <title>JavaScript</title>

    <!-- Bootstrap core CSS -->
    <link href="bootstrap/css/bootstrap.min.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="media/fabacademy.css" rel="stylesheet">
    
    <!-- 3D files viewer -->
    <script type="text/javascript" src="media/jsc3d_ie.min.js"></script>
	<script type="text/javascript" src="media/jsc3d.min.js"></script>
    <script type="text/javascript" src="media/jsc3d.webgl.js"></script>
    <script type="text/javascript" src="media/jsc3d.touch.js"></script>

    <!-- Just for debugging purposes. Don't actually copy these 2 lines! -->
    <!--[if lt IE 9]><script src="bootstrap/js/ie8-responsive-file-warning.js"></script><![endif]-->
    <script src="bootstrap/js/ie-emulation-modes-warning.js"></script>

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <!-- Load the menu file -->
    <script>
	function menu() {
					  $('#exercises').load("exercises-menu.html");
					  $('#project').load("project-menu.html");
					  $('#cclicense').load("license.html");
					  }
	</script>

  </head>

  <body onload="menu()">      

    <!-- Static navbar -->
    <nav class="navbar navbar-default navbar-static-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="index.html">Joern Kiwitt</a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li><a href="about.html">About</a></li>
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Exercises <span class="caret"></span></a>
              <ul id="exercises" class="dropdown-menu" role="menu">
              </ul>
            </li>
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Final Project <span class="caret"></span></a>
              <ul id="project" class="dropdown-menu" role="menu">
              </ul>
            </li>
            <li><a href="contact.html">Contact</a></li>
        </ul>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">

	<!-- Insert your content here below! -->


     <h2>Working with APIs</h2>
    
    <h3>Menu</h3>
	<p>
    I wanted to learn some basic things about the use of APIs, RESTful services, HTTP requests and so on. I found <a href="http://www.codecademy.org">Codecademy</a> which turned out to a helpful resource.
    </p>
    
    <p>The number of HTTP methods is just four. These are:</p>

    <ul>
        <li>GET: retrieves information from the specified source (you just saw this one!)</li>
        <li>POST: sends new information to the specified source.</li>
        <li>PUT: updates existing information of the specified source.</li>
        <li>DELETE: removes existing information from the specified source.</li>
    </ul>
        
    <p>A GET request for instance, looks like this:</p>
    <pre>var xhr = new XMLHttpRequest();
xhr.open("GET", "eiszeitfrucht.de", false);
// Add your code below!
xhr.send()
console.log(xhr.status)
console.log(xhr.statusText)</pre>
        
<p>Have a look <a href="https://www.codecademy.com/courses/javascript-beginner-en-EID4t/1/3?curriculum_id=50ecb8d45f787a6332000042">here</a>.</p>        
        
    <h3>Parsing XML</h3>

        <p>XML (which stands for E xtensible Markup Language) is very similar to HTMLâ€”it uses tags between angle brackets. The difference is that XML allows you to use tags that you make up, rather than tags that the W3C decided on.</p>
        
        <p>XML is an alternative to JSON. JSON is a faster to implement though. </p>
        
    <h2>JS basics</h2>
        
    <p>Follow this tutorial <a href="https://www.codecademy.com/learn/introduction-to-javascript">here</a>.</p>
        
    <p>Using the console with <code>console.log()</code>. Use the <code>Math</code>-library as well as the numbers library. Use of mathematical operators. Use of different data types, e. g. string, number, boolean and null. A variable can be undefined, if no value is assigned to it</p>
            
    <!-- End of your content -->

    <h3>Const and let variables</h3>
        
    <p><code>const</code> cannot be change, <code>let</code> can be changed.</p>
        
    <h3>String interpolation</h3>
        
    <p>I. e. inserting "things" into a strong. Use the '+' operator. In ES6, you can use backticks instead. <code>console.log(`I own a pet ${myPet}.`)</code></p>
        
    <h3>If/else</h3>
        
    <p>All variables that have been created and set are truthy (and will evaluate to true if they are the condition of a control flow statement), unless '0', 'false', etc.</p>
        
    <pre>if()
    {...}
    else
    {...}</pre>
        
    <p>For comparison use the <code>===</code> operator. As an alternative, you can use <code>switch</code>.</p>
        
    <pre>
switch (xyz){
case 'tomato':
...
break;

case 'salad':
...
break;

default:
...
break;
}
    </pre>
        
        <p>With the <b>Ternary operator</b> you can shorten the if-condition significantly. This type <b>?</b> after the condition following by the "true"-block and separte the "else"-block with a colon (:).</p>
        
<h3>Functions</h3>
        
    <p>Arrow token <code>nameOfTheFunction (argmument) => {... return x;}</code>. 
        
    <p>There are some simplifications possible:</p>
        
    <ul>
        <li>Single argument functions do not even need brackets.</li>
        <li>Single line functions can also use <b>implicit return</b> without actually having the necessity to mention the key world in the code.</li>
        <li>Single line functions do not rely on curly brackets to separate the function block.</li>
    </ul>
        
<h3>Function Declarations</h3>
        
    <pre>
function isGreaterThan(numberOne, numberTwo){
  if(numberOne>numberTwo) {
    return true;
  }
  else {
    return false;
  }
}

isGreaterThan(2,1);    
    </pre>
        
    <h3>Functions Expressions</h3>        

    <p>Does not contain a function identifier, stored in a variable. You can also abbreviate but gettin rid of "function" and using the =&lt>.</p>
        
    <pre>        
const square = function (number) {
  return number * number;
};

console.log(square(5));
// Output: 25.
    </pre>        
        
<h3>Scope</h3>
        
    <p>There are local and global variables, these have different scope. Avoid using global variable, as it might cause interference with local ones.</p>
        
    <p>Especially, loop variable - such as the ones in a for-loop - are of local scope.</p>
        
    <pre>for (let i=0; i &lt 12; i++){
console.log(i);
    };</pre>
    
    <p>Calling a variable outside its scope will return a <b>reference error</b>.</p>
        
<h3>Arrays</h3>
    <p>The key concept of an array is store and retrieve data. It is like a custom list.</p>
        
<pre>let newYearsResolutions = ['','',''];</pre>
        
    <p>The <code>pop</code>-method removes the last item of an array, the <code>push</code>-message adds items.</p>
        
    <p>Arrays can be of type <code>let</code> or <code>const</code>. Items of both can be changed, however items of an array of const-type can't be changed in length or data type.</p>
        
<h3>Loops</h3>
        
<p>For-Loop are good, but you need to in advance how often you want to loop. <b>While</b>-loops wait for a condition to stop. Use unequal <code>==!</code> or the equal <code>===</code> sign to define your condition. However, be sure that the while-condition is met at some point, otherwise it will loop to infinity.</p>
        
<h3>Iterators</h3>
        
<p><code>Map</code>, <code>forEach</code> and <code>filter</code> are typical array operator. These are actually simplified loop-calls.</p>

<p>Need to know about <code>forEach</code>:</p>
<ul>
    <li>methods only work on arrays</li>
    <li>won't change the actual array</li>
    <li>return value is undefined</li>
</ul>

<p>In the <code>forEach</code>-iterator, each argument is handed over to the variable in the function.</p>

<p>Function definition:</p>
<pre>fruits.forEach(function(groceryItem){
  console.log('I want to eat a ' + groceryItem)
});</pre>
        
<p>Alternatively, use arrow syntax:</p>
<pre>fruits.forEach((groceryItem) => console.log('I want to eat a ' + groceryItem));</pre>
        
<p>The <code>map</code>-iterator however <b>does change</b> the array.</p>
        
<pre>let secretMessage = animals.map(function(firstLetter){
  return firstLetter[0];
})</pre>
        
<p>or:</p>
        
<pre>let smallNumbers = bigNumbers.map(num => num/100);</pre>
        
<p>The variable inside the brackets is <b>local</b>!</p>
        
<p>In the <code>filter</code> iterator, you need to hand over the filter condition:</p>
        
<pre>let smallNumbers = randomNumbers.filter(item => item.length &lt 250);</pre>

<p>The <code>every</code> method returns a boolean value.</p>
        
<h3>Objects</h3>
        
<p>Complex data types can be writen in JSON like this:</p>
        
<pre>let person = {
  name: 'Joern',
  age: 32,
}

console.log(person.name);</pre>
        
<p>Single attribute or <b>key</b> can be accessed with a '<code>.</code>' . Alternative, brackets can be used:</p>
        
<pre>console.log(person['name']);
console.log(person['age']);</pre>
        
<p>Keys can also be accessed by variables, e. .:</p>

<pre>let person = {
  name: 'Joern',
  age: 32,
  weekendAlarm: 'No alarms needed',
  weekAlarm: 'Alarm set to 7AM',
}

let day ='Monday';
let alarm;

if (day ==='Saturday' || day === 'Sunday'){
  alarm = 'weekendAlarm';
}
else{
  alarm = 'weekAlarm';
};

console.log(person['name']);
console.log(person['age']);
console.log(person[alarm])</pre>

<p>Within an object, you can also have methods, like this (new ES6 notation):</p>
        
<pre>sayHello() {return 'Hello, there!'},</pre>
        
<p>Calling a function works just like calling a key, using the <code>.</code>operator.</p>
        
<h4>This keyword</h4>
        
<p>To make functions able to access to objects keys, the <code>this</code> keyword is needed. It works only inside the object and equals the call of key with the <code>.</code>operator in the <b>outside world</b>.</p>

<pre>sayHello () {return `Hello, my name is ${this.name}!`},</pre>

<p>This can limit the scope of a function to the calling object.</p>
        
<pre>let friend = {
  name: 'Maurice',
}
friend.sayHello=person.sayHello;
</pre>

<p>Outputting the result of <code>friend.sayHello</code> will you gave your friends name, instead of <code>person</code> name.</p>
        
<h4>Getters & setters</h4>

    <p>As the name implies, setter methods or used to <b>set</b> keys. They are "allowed" to access and perform validity checks on data type and scope.</p>
        
<pre> set age(ageIn) {
    if (typeof ageIn === 'number') {
      this._age = ageIn;
    }
    else {
      console.log('Invalid input');
      return 'Invalid input';
    }
  }
}</pre>
        
<p>Getter methods also carry the same name as the property they are accessing. They are tagged with the keyword <b>get</b>.</p>

<pre>
...,
get age() {
    console.log(`${this._name} is ${this._age} years old.`);
    return this._age;
  }

};

person.age;</pre>
        
<h3>Classes</h3>
        
<p>Important difference to objects is the constructor method. It is called to create an object.</p>
        
<pre>class Surgeon {
  constructor(name, department){
    this.name = name;
    this.deparment = department;
  }
</pre>
  
<p>To call it:</p>
<pre>const surgeonCurry = new Surgeon('Curry','Cardiovascular');</pre>

<p>Class method and getter syntax is the same as it is for objects except <b>you can not include commas between methods.</b></p>
        
<h4>Inheritance</h4>
        
<p>Avoid rewriting huge amounts of code by inheriting properties from one parent class to a child class, e. g. cat is a derivative from the animals class.</p>
        
<pre>class Cat extends Animal {
  constructor(name, usesLitter) {
    super(name);
    this._usesLitter = usesLitter;
  }
}</pre>
 
<p>It uses the keywords <b>extends</b> and <b>super</b>. Extends makes the methods of the parent class available, accepting the keyword name, which is defined in the parent class. The keyword <b>super</b> passes the argument to the parent class' constructor (<b>write super as your first line, in order not to forget it!</b>). The new property property is defined in the derived constructor of the cat class. </p>

<pre>class HospitalEmployee {
  constructor(name) {
    this._name = name;
    this._remainingVacationDays = 20;
  }
  
  get name() {
    return this._name;
  }
  
  get remainingVacationDays() {
    return this._remainingVacationDays;
  }
  
  takeVacationDays(daysOff) {
    this._remainingVacationDays -= daysOff;
  }
}

class Nurse extends HospitalEmployee {
  constructor(name, certifications) {
    super(name);
    this._certifications = certifications;
  } 
  
  get certifications() {
    return this._certifications;
  }
  
  addCertification(newCertification) {
    this.certifications.push(newCertification);
  }
}

const nurseOlynyk = new Nurse('Olynyk', ['Trauma','Pediatrics']);
nurseOlynyk.takeVacationDays(5);
console.log(nurseOlynyk.remainingVacationDays);
nurseOlynyk.addCertification('Genetics');
console.log(nurseOlynyk.certifications);</pre>
    
<h4>Static methods</h4>
        
<p>Static methods cannot be called from an instances, but only from the class itself, e. g. <b>HospitalEmployee</b>.</p>
        
<h3>Browser Compatibility & Transpilation</h3>
        
<p>There is often time between a new JavaScript version (e. g. ES6) and the time the browsers are ready to use it. Two valuable resource to check compatibility issues:</p>

<ul>
    <li><a href="https://caniuse.com/">caniuse.com</a> â€” A website that provides data on web browser compatibility for HTML, CSS, and JavaScript features. You will learn how to use it to look up ES6 feature support.</li>
    <li>Babel â€” A Javascript library that you can use to convert new, unsupported JavaScript (ES6), into an older version (ES5) that is recognized by most modern browsers.</li>
</ul>        

<p>To use Babel, follow these steps:</p>
        
<pre>npm install babel-cli
npm install babel-preset-env
npm run build
</pre>
        
<p>This then transpiles your code to ES5. Before we can add Babel to our project directory, we need to <code>run npm init</code>. The npm init command creates a package.json file in the root directory, which <b>/src</b>.</p>

<p>A package.json file contains information about the current JavaScript project. Some of this information includes:</p>

<ul>
    <li>Metadata â€” This includes a project title, description, authors, and more.</li>
    <li>A list of node packages required for the project â€” If another developer wants to run your project, npm looks inside package.json and downloads the packages in this list.</li>     
</ul>

<p>The -D flag instructs npm to add each package to a property called <b>devDependencies</b> in package.json. Once the project's dependencies are listed in devDependencies, other developers can run your project without installing each package separately. Instead, they can simply run npm install â€” it instructs npm to look inside package.json and download all of the packages listed in devDependencies.</p>

<pre>$ npm install babel-cli -D
$ npm install babel-preset-env -D</pre>
        
<p>To create the babelrc file use:</p>
<pre>touch .babelrc</pre>
        
<p>Create an obj. called:</p>
<pre>{
  "presets": ["env"]
}</pre>
        
<p>Open the package.json file and the line which begin with <b>build</b>. The property's value, "babel src -d lib", is a command line method that transpiles ES6+ code to ES5. </p>

<pre>{
  "name": "browsercomp",
  "version": "1.0.0",
  "description": "test transpilation es6 to es5",
  "main": "index.js",
  "scripts": {
    "test": "echo \"Error: no test specified\" && exit 1"
  },
  "build": "babel src -d lib"
  "author": "",
  "license": "ISC",
  "devDependencies": {
    "babel-cli": "^6.26.0"
  }
}
</pre>
        
<p>Finally, call build from the command line.</p>
        
<p>npm run build</p>
        
<p>The new <b>main.js</b> file is writen to the <b>lib</b> directory.</p>
        
<h3>Intermediate JavaScript Modules</h3>
        
<p>The pattern we use to export modules is thus:</p>

<ul>
    <li>Define an object to represent the module.</li>
    <li>Add data or behavior to the module.</li>
    <li>Export the module.</li>
</ul>

<p>Define the module in a file called <b>1-airplane.js</b>.</p>
<pre>let Airplane ={
  myAirplane: "StarJet",
};

module.exports = Airplane;</pre>
        
<p>Create a new file <b>1-missionControl.js</b> and import the module. Test by calling the modules property.</p>
        
<pre>const Airplane = require('./1-airplane.js');

function displayAirplane(){ console.log(Airplane.myAirplane);
};

displayAirplane();</pre>
        
<h4>Export default</h4>
        
<p>Default export: one module per file!</p>
    
<pre>let Airplane = {};

Airplane.availableAirplanes = [
{
  name: 'AeroJet',
  fuelCapacity: 800
 }, 
 {name: 'SkyJet',
  fuelCapacity: 500
 }
];

export default Airplane;</pre>
        
<p>And import it:</p>
        
<pre>import Airplane from './airplane';

function displayFuelCapacity(){
  Airplane.availableAirplanes.forEach(function(element){
    console.log('Fuel Capacity of ' + element.name + ': ' + element.fuelCapacity);
  });
};

displayFuelCapacity();</pre>
        
<h4>Named exports</h4>
        
        <p>Export each element by name.</p>
        
<pre>let availableAirplanes = [
{
  name: 'AeroJet',
  fuelCapacity: 800,
  availableStaff: ['pilots', 'flightAttendants','engineers','medicalAssistance','sensorOperators']
 }, 
 {name: 'SkyJet',
  fuelCapacity: 500,
  availableStaff: ['pilots', 'flightAttendants']
 }
];

let flightRequirements = {
  requiredStaff: 4
};

function meetsStaffRequirements(availableStaff, requiredStaff) {
  if (availableStaff.length>=requiredStaff){
    return true;
  }
  else {
    return false;
  }
};

export {availableAirplanes, flightRequirements, meetsStaffRequirements};</pre>
        
<p>The same works for imports:</p>
        
<pre>import {availableAirplanes, flightRequirements, meetsStaffRequirements} from './airplane';</pre>
        
<h4>Export named exports</h4>
        
        <p>Export variables on declaration:</p>
        
<pre>export let flightRequirements = {
  requiredStaff: 4,
  requiredSpeedRange: 700
};

export function meetsStaffRequirements(availableStaff, requiredStaff) {
  if (availableStaff.length>=requiredStaff){
    return true;
  }
  else {
    return false;
  }
};</pre>
        
<h4>Import named imports</h4>
        
        <p>no change</p>
        
<h4>Export as</h4>
        
        <p>This lets you export the variable under a different name.</p>
        
<pre>export{availableAirplanes as aircrafts, ...}</pre>
        
        <p>This works the same for importing. Another way of doing it is aliasing on import.</p>
        
<h3>Requests</h3>
        
        <p>JavaScript is an asynchronous language, i. e. you can use partly loaded content and handle multiple request to the server in an <b>event loop</b>. Longer messages are broken into smaller messages that are ready to run.</p>
        
        <p>When asking for content from other websites, we separate the request from what we do with the response. For this, we use <b>Asynchronous JavaScript and XML (AJAX)</b>.</p>
        
        <h4>API authentification - example Google URL Shortener</h4>
        
        <p>A resource you might want to have a look at is <a href="https://developers.google.com/url-shortener/v1/getting_started">Google URL Shortener</a>.</p>
        
        <p>Client ID and client secret (aquivalent to user and password) for OAuth authentification.</p>
        
        <p>To access the URL shortener via JavaScript requests, you need create an API key. Follow this instruction <a href="https://www.codecademy.com/articles/google-api">here</a>.</p>
        
        <ul>
            <li>Create a google account that is associated to your project or use your own.</li>
            <li>Go to the <b>Google API</b> dashboard.</li>
            <li>Create a webserver access API, that is public.</li>
            <li>Copy the API key.</li>
        </ul>
                
        <h4>Http requests</h4>
        
    <p>We have been discussing http request before, so just as a quick reminder:</p>

    <ul>
        <li>GET: requests receive information from the specified source (you just saw this one!) --> <b>like a Google search terms, these are added to the URL!</b> <code>https://www.google.com/#q=pizza+near+union+square</code></li>
        <li>POST: change information in the specified source and receive information in response. Instead of sending information in the URL, it is sent as part of the body of the request.</li>
        <li>PUT: updates existing information of the specified source.</li>
        <li>DELETE: removes existing information from the specified source.</li>
    </ul>        
        
    <h4>GET request</h4>
        
        <p>here are several steps to creating an AJAX request using an XMLHttpRequest, or XHR, object.</p>
        
        <div class="container">        
            <div class="col-sm-6">             
                <a href="media/images/03_APIs/AJAX_request.png"> 
                    <img class="img-thumbnail" src="media/images/03_APIs/AJAX_request.PNG" alt="image AJAX_request">   
                </a>
                <legend>AJAX Request</legend>
            </div>
        </div> 
        
        <ul>
        <li>On the first line, we create an XMLHttpRequest object. We do that by typing new, then the type of object, XMLHttpRequest(). This is called the new operator.</li>

        <li>The object is saved in a const called xhr. </li>

        <li>On the next line, we save the URL to which the request is sent.</li>

        <li>We set the responseType of the xhr object to 'json'.</li>

        <li><code>onreadystatechange</code> is an event handler that is called whenever the value of the <code>readyState</code> property changes.</li>

        <li>if <code>readyState</code> of our xhr object is equal to <code>XMLHttpRequest.DONE</code>, the code in the block executes.</li>

        <li>Then, we call the <code>.open()</code> method on our xhr object and pass it two arguments - 'GET' (the type of request) and url, the URL we're querying. <code>.open()</code> creates and structures the request. It tells the request what method to use, GET or POST, and what URL to query.

        <li>Finally, we call the <code>.send()</code> method on our xhr object and pass it no arguments. This is because data sent in GET requests is sent as part of the URL. Calling the .send() method sends the xhr object with its relevant information to the API URL. </li>
        </ul>
        
<pre>const xhr = new XMLHttpRequest;
const url = 'https://api-to-call.com/endpoint';
xhr.responseType = 'json';
xhr.onreadystatechange = function (){
  if (xhr.readyState === XMLHttpRequest.DONE) {
	console.log(xhr.response);
	}
};

xhr.open('GET',url);
xhr.send();</pre>
        
<h4>Using an API key</h4>

<p>The API needs to be added as a variable.</p>
        
<pre>function expandUrl() {
const urlToExpand = url + '?key=' + apiKey + '&amp shortUrl=' + $inputField.val();
}</pre>
        
<p>The code above adds two query parameters to the API URL. We need to tell Google which short URL we want to expand and we need to provide our API key, which is how we get permission from Google to use this service.</p>        
        
<pre>function expandUrl() {
const urlToExpand = url + '?key=' + apiKey + '&amp shortUrl=' + $inputField.val();
const xhr = new XMLHttpRequest;
xhr.responseType = 'json';
xhr.onreadystatechange = function (){
    if (xhr.readyState === XMLHttpRequest.DONE) {
  		$responseField.append('&ltp>Your expanded url is: &lt/p>&ltp>' + xhr.response.longUrl + '&lt/p>');
		}
    };
  xhr.open('GET', urlToExpand);
  xhr.send();
}</pre>    
        
        <div class="container">        
            <div class="col-sm-6">             
                <a href="media/images/03_APIs/ShortenedResponse.PNG"> 
                    <img class="img-thumbnail" src="media/images/03_APIs/ShortenedResponse.PNG" alt="image AJAX_request">   
                </a>
                <legend>Long url response</legend>
            </div>
        </div>      
        
<h4>POST requests</h4>
        
        <div class="container">        
            <div class="col-sm-6">             
                <a href="media/images/03_APIs/AJAX_request_POST.PNG"> 
                    <img class="img-thumbnail" src="media/images/03_APIs/AJAX_request_POST.PNG" alt="image AJAX_request">   
                </a>
                <legend>POST request</legend>
            </div>
        </div>      
                
        
<p>In a POST request, the information is sent to the server as part of the body of the request. This information is created and saved in the <b>data constant</b> and sent to the API as an argument passed to the .send() method.</p>
        
<p>The first two lines are identical, the third line containts the object containing the data that is passed to the JSON.stringify() method, which will format the object as a string. This is saved to a const called data. </p>
        
<p>Everything else remains the same until the final two lines. When we call the .open() method on the xhr object, we pass the argument 'POST' instead of 'GET'. Finally, we pass the data string to the .send() method. </p>
        
        <div class="container">        
            <div class="col-sm-6">             
                <a href="media/images/03_APIs/ShortenedResponse_Shorten.PNG"> 
                    <img class="img-thumbnail" src="media/images/03_APIs/ShortenedResponse_Shorten.PNG" alt="image AJAX_request">   
                </a>
                <legend>Shorten response</legend>
            </div>
        </div>  
        
<pre>function shortenUrl() {
  const urlWithKey = url + '?key=' + apiKey;
  const urlToShorten = $inputField.val();
  const data = JSON.stringify({longUrl: urlToShorten});
  const xhr = new XMLHttpRequest;
  xhr.responseType = 'json';
  xhr.onreadystatechange = function(){
    if (xhr.readyState === XMLHttpRequest.DONE) {
  		$responseField.append('<p>Your shortened url is: &lt/p>&ltp>' + xhr.response.id + '&lt/p>');
		}
  }
  xhr.open('POST', urlWithKey);
  xhr.setRequestHeader('Content-Type', 'application/json');
  xhr.send(data);
}</pre>     
        
<h4>$.ajax() GET Requests I</h4>
        
<p>You can also methods from the <b>jQuery library</b>, to simply the code for a request. Use AJAX (JavaScript, but XML notation!).</p>        
        
        <div class="container">        
            <div class="col-sm-6">             
                <a href="media/images/03_APIs/jQuery_GET.PNG"> 
                    <img class="img-thumbnail" src="media/images/03_APIs/jQuery_GET.PNG" alt="image AJAX_request">   
                </a>
                <legend>jQuery GET request</legend>
            </div>
        </div>    
        
<h4>$.ajax() POST Requests I</h4>
        
<p></p>
        <div class="container">        
            <div class="col-sm-6">             
                <a href="media/images/03_APIs/AJAX_request_POST_Jquery.PNG"> 
                    <img class="img-thumbnail" src="media/images/03_APIs/AJAX_request_POST_Jquery.PNG" alt="image AJAX_request">   
                </a>
                <legend>jQuery POST request</legend>
            </div>
        </div>          
        
<h4>AJAX requests with $.get()</h4>
        
<pre>function expandUrl() {
	const urlToExpand = url + '?key=' + apiKey + '&shortUrl=' + $inputField.val();
  $.get(urlToExpand, response => {
  $responseField.append('<p>Your expanded url is: </p><p>' +
  response.longUrl + '</p>')}, 'json')
}
</pre>
        
<h4>AJAX requests with $.post()</h4>
        
<pre>  $.post({
    url: urlWithKey,
    data: JSON.stringify({longUrl: urlToShorten}),
    dataType: 'json',
    contentType: 'application/json',    
    success(response){$responseField.append('<p>Your shortened url is: </p><p>' + response.id + '</p>');},
    error(jqXHR,status,errorThrown){console.log(jqXHR)},
  });</pre>        
       
<h4>AJAX Requests with $.getJSON()</h4>
                
<pre>function expandUrl() {
	const urlToExpand = url + '?key=' + apiKey + '&shortUrl=' + $inputField.val();
  $.getJSON(urlToExpand, response => {
  $responseField.append('<p>Your expanded url is: </p><p>' +
  response.longUrl + '</p>')})
}</pre>
        
<h3>Review</h3>
        
<ol>
    <li>JavaScript is the language of the web because of its asynchronous capabilities. A set of tools that are used together to take advantage of JavaScript's asynchronous capabilities is called AJAX, which stands for Asynchronous JavaScript and XML.</li>
    <li>There are four HTTP request methods, two of which are GET and POST.</li>
    <li>GET requests only request information from other sources.</li>
    <li>POST methods can introduce new information to other sources in addition to requesting it.</li>
    <li>GET requests can be written using an XMLHttpRequest object and vanilla JavaScript.</li>
    <li>POST requests can also be written using an XMLHttpRequest object and vanilla JavaScript.</li>
    <li>Writing GET and POST requests with XHR objects and vanilla JavaScript requires constructing the XHR object using new, setting the responseType, creating a function that will handle the response object, and opening and sending the request.</li>
    <li>Much of the boilerplate used to write GET and POST requests with XHR and vanilla JavaScript can be reduced by using the $.ajax() method from the jQuery library.</li>
    <li>jQuery provides other helper methods that can further reduce boilerplate such as $.get(), $.post(), and $.getJSON().</li>
    <li>Determining how to correctly write the requests and how to properly implement them requires carefully reading the documentation of the API with which you're working.</li>
</ol>
        
<h4>Fetch() GET requests</h4>
        
        <div class="container">        
            <div class="col-sm-6">             
                <a href="media/images/03_APIs/fetch_GET_request.PNG"> 
                    <img class="img-thumbnail" src="media/images/03_APIs/fetch_GET_request.PNG" alt="image fetch_GET_request">   
                </a>
                <legend>fetch GET request</legend>
            </div>
        </div>  
        
<pre>// Include data for accessing Google APIs
const apiKey = '&lt Your API Key>';
const url = 'https://www.googleapis.com/urlshortener/v1/url';

// Some page elements

const $inputField = $('#input');
const $expandButton = $('#expand');
const $shortenButton = $('#shorten');
const $responseField = $('#responseField');

// AJAX functions

function expandUrl() {
	const urlToExpand = url + '?shortUrl=' + $inputField.val() + ' &amp;key=' + apiKey;
  fetch(urlToExpand).then(response => {
    if (response.ok) {
      return response.json();
    }
    throw new Error('Request failed!');
  }, networkError => console.log(networkError.message));
};


function shortenUrl() {

};

function expand() {
  $responseField.empty();
  expandUrl();
  return false;
};

function shorten() {
  $responseField.empty();
  shortenUrl();
  return false;
};

$expandButton.click(expand);
$shortenButton.click(shorten);
</pre>
    
<h4>Fetch() POST requests</h4>
        
        <div class="container">        
            <div class="col-sm-6">             
                <a href="media/images/03_APIs/fetch_POST_request.PNG"> 
                    <img class="img-thumbnail" src="media/images/03_APIs/fetch_POST_request.PNG" alt="image fetch_GET_request">   
                </a>
                <legend>fetch POST request</legend>
            </div>
        </div> 
        
<p>Nested then function can be tricky.</p>
        
<pre>fetch('https://api-to-call.com/endpoint', {
  method: 'POST',
  body: JSON.stringify({id: '200'})
}).then(response => {
  	if(response.ok) {
      return response.json();
    }
  	throw new Error('Request failed!');
	}, networkError => console.log(networkError.message)
).then(jsonResponse => jsonResponse);</pre>
        
<h4>async GET Requests</h4>
        
<p></p>        
   
        <div class="container">        
            <div class="col-sm-6">             
                <a href="media/images/03_APIs/Async_Await_GET.PNG"> 
                    <img class="img-thumbnail" src="media/images/03_APIs/Async_Await_GET.PNG" alt="image fetch_GET_request">   
                </a>
                <legend>async GET request</legend>
            </div>
        </div>         
        
<pre>// AJAX functions
async function expandUrl(){
  const urlToExpand = url + '?shortUrl=' + $inputField.val() + '&amp;key=' + apiKey;
  try{
		let response = await fetch(urlToExpand);
    if (response.ok){
      let jsonResponse = await response.json();
      $responseField.append('<p> Your expanded URL is </p><p>' + jsonResponse.longUrl+ '</p>');
      return jsonResponse;
    }
  }
  catch(error){
    console.log(error);
  };
  
};</pre>
   
<h4>async POST Requests I</h4>

<p></p>
        
        <div class="container">        
            <div class="col-sm-6">             
                <a href="media/images/03_APIs/Async_Await_POST.PNG"> 
                    <img class="img-thumbnail" src="media/images/03_APIs/Async_Await_POST.PNG" alt="image fetch_GET_request">   
                </a>
                <legend>async POST request</legend>
            </div>
        </div>          
        
<pre>async function getData(){
  try{
    let response = await fetch('https://api-to-call.com/endpoint',{
      method: 'POST',
      body: JSON.stringify({id: 200}),
    });
  } catch (error){
    console.log(error);
  }
}</pre>    
        
<p>In this case:</p>
        
<pre>async function shortenUrl(){
  const urlToShorten = $inputField.val();
	const urlWithKey = url + '?key=' + apiKey;
  
  try{
    let response = await fetch(urlWithKey,{
      method: 'POST',
      body: JSON.stringify({longUrl: urlToShorten}),
      headers: {"Content-type": "application/json"},
    });
    if (response.ok){
      let jsonResponse = await response.json();
      $responseField.append('<p> Your shortened URL is </p><p>' + jsonResponse.id + '</p>');
return jsonResponse;
    }
  } catch (error) {
    console.log(error);
  };
};</pre>
        
<h3>Summary</h3>
        
<ul>
    <li>GET and POST requests can be created a variety of ways.</li>
    <li>We can asynchronously request data from APIs using AJAX. fetch() and async/await are new technologies developed in ES6 and ES7 respectively.</li>
    <li>Promises are a new type of JavaScript object that represent data that will eventually be returned from a request.</li>
    <li>fetch() is a web API that can be used to create requests. fetch() will return Promises.</li>
    <li>We can chain .then() methods to handle Promises returned by fetch.</li>
    <li>The .json() method converts a returned Promise to a JSON object.</li>
    <li>async is a keyword that is used to create functions that will return Promises.</li>
    <li>await is a keyword that is used to tell a program to continue moving through the message queue while a Promise resolves.</li>
    <li>await can only be used within functions declared with async.</li>
</ul>
        
</div> <!-- /container -->
      
	<!-- footer -->
    
    <footer id="footer">
        <p id="cclicense">
                </p>
        <p class="license">
        Theme: <a href="https://github.com/openp2pdesign/FabAcademy_Template">Fab Academy Template</a> by <a href="http://openp2pdesign.org">Massimo Menichinelli</a> <br>
        Based on <a href="http://getbootstrap.com/">Twitter Bootstrap</a>+<a href="http://jquery.com/">JQuery</a>+<a href="https://code.google.com/p/google-code-prettify/">google-code-prettify</a>+<a href="http://jmblog.github.io/color-themes-for-google-code-prettify/github/">GitHub theme for google-code-prettify</a>+<a href="https://code.google.com/p/jsc3d/">JSC3D</a>+<a href="https://github.com/thegrubbsian/jquery.ganttView">jquery.ganttView</a>.
        </p>
    </footer>
    

	<!-- Do not touch this! -->
    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="media/jquery-1.9.1.min.js"></script>
    
    <!-- Syntax Highlighter -->
    <script src="https://google-code-prettify.googlecode.com/svn/loader/run_prettify.js">
    </script>
    <!-- From https://github.com/jmblog/color-themes-for-google-code-prettify -->
    <link href="media/github.css" type="text/css" rel="stylesheet">
	<script type="text/javascript">
	  !function ($) {
		$(function(){
		  window.prettyPrint && prettyPrint()   
		})
	  }(window.jQuery)
	</script>
	
    <script src="bootstrap/js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="bootstrap/js/ie10-viewport-bug-workaround.js"></script>

  </body>
</html>
